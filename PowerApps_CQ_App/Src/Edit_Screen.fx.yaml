Edit_Screen As screen:
    OnVisible: |-
        =UpdateContext({_V_errormsg:false});

    mainContainer_1 As groupContainer.manualLayoutContainer:
        Height: =1136
        Width: =640
        ZIndex: =2

        Form1_4 As form:
            DataSource: =Attendees
            Height: =930
            Item: |-
                =//Gallery3_4.Selected
                LookUp(col_allAttendee,Attendees=Gallery3_4.Selected.Attendees)
            Width: =640
            Y: =100
            ZIndex: =1

            Email_DataCard1_1 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ulcq_email"
                Default: =ThisItem.Email
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@Attendees],DataSourceInfo.DisplayName,"ulcq_email")
                Fill: =RGBA(0, 0, 0, 0)
                Height: |-
                    =If(
                        lbl_NotValidError.Visible = true && lbl_alreadyExistError.Visible = true,
                        154,
                        132
                    )
                MaxLength: =DataSourceInfo([@Attendees], DataSourceInfo.MaxLength, "ulcq_email")
                Required: =true
                Update: =DataCardValue1_3.Text
                Width: =640
                X: =0
                Y: =1
                ZIndex: =1

                DataCardKey1_3 As label:
                    AutoHeight: =true
                    FontWeight: =FontWeight.Semibold
                    Height: =48
                    Size: =15
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue1_3 As text:
                    BorderColor: =If(IsBlank(Parent.Error) && DataCardValue1_3.Text exactin col_allAttendee[@ulcq_email] || (IsMatch(DataCardValue1_3.Text,Match.Email) || IsBlank(DataCardValue1_3.Text)), Color.Black, Color.Red)
                    BorderThickness: =1
                    Default: =ThisItem.Email
                    DelayOutput: =true
                    DisplayMode: |-
                        =If(
                            Form1_4.Mode = FormMode.Edit && !IsBlank(
                                LookUp(
                                    Attendees,
                                    Attendees = _V_id
                                ).Territory
                            ),
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Height: =70
                    HintText: ="abcd@gmail.com"
                    HoverBorderColor: =If(IsBlank(Parent.Error) && DataCardValue1_3.Text exactin col_allAttendee[@ulcq_email] || (IsMatch(DataCardValue1_3.Text,Match.Email) || IsBlank(DataCardValue1_3.Text)), Color.Black, Color.Red)
                    HoverFill: =Self.Fill
                    MaxLength: =Parent.MaxLength
                    PressedBorderColor: =Self.Fill
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey1_3.Y + DataCardKey1_3.Height + 5
                    ZIndex: =2

                ErrorMessage1_3 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue1_3.Y + DataCardValue1_3.Height
                    ZIndex: =3

                StarVisible1_3 As label:
                    Align: =Align.Center
                    Color: =Color.Red
                    Height: =DataCardKey1_3.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey1_3.Y
                    ZIndex: =4

                lbl_NotValidError As label:
                    Color: =RGBA(255, 0, 0, 1)
                    Height: =14
                    Size: =14
                    Text: =If(IsMatch(DataCardValue1_3.Text,Match.Email) || IsBlank(DataCardValue1_3.Text),"","*Please Enter a valid Email")
                    Visible: =If((IsMatch(DataCardValue1_3.Text,Match.Email) && Form1_4.Mode=FormMode.Edit) || IsBlank(DataCardValue1_3.Text),false,true)
                    Width: =560
                    X: =40
                    Y: =132
                    ZIndex: =5

                lbl_alreadyExistError As label:
                    Color: =RGBA(255, 0, 0, 1)
                    Height: =lbl_NotValidError.Height
                    Size: =14
                    Text: ="*This Email Id is already exist"
                    Visible: =If(DataCardValue1_3.Text exactin col_allAttendee[@ulcq_email] && Form1_4.Mode=FormMode.New,true,false)
                    Width: =lbl_NotValidError.Width
                    X: =lbl_NotValidError.X
                    Y: =lbl_NotValidError.Y
                    ZIndex: =6

            Area_DataCard2 As typedDataCard.comboBoxEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ulcq_Area"
                Default: =ThisItem.Area
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@Attendees],DataSourceInfo.DisplayName,"ulcq_Area")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =DataCardValue7.Selected
                Width: =640
                X: =0
                Y: =2
                ZIndex: =1

                DataCardKey7 As label:
                    AutoHeight: =true
                    Height: =48
                    Size: =21
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue7 As combobox:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    ChevronBackground: =RGBA(255, 139, 76, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisplayFields: =["ulcq_name"]
                    DisplayMode: =Parent.DisplayMode
                    Height: =70
                    HoverFill: =RGBA(251, 188, 159, 1)
                    Items: =Choices([@Attendees].ulcq_Area)
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    SearchFields: =["ulcq_name"]
                    SearchItems: =Search(Choices([@Attendees].ulcq_Area),DataCardValue7.SearchText,"ulcq_name")
                    SelectMultiple: =false
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey7.Y + DataCardKey7.Height + 5
                    ZIndex: =2

                ErrorMessage12 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue7.Y + DataCardValue7.Height
                    ZIndex: =3

                StarVisible12 As label:
                    Align: =Align.Center
                    Height: =DataCardKey7.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey7.Y
                    ZIndex: =4

            Territory_DataCard2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ulcq_territory"
                Default: =ThisItem.Territory
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@Attendees],DataSourceInfo.DisplayName,"ulcq_territory")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@Attendees], DataSourceInfo.MaxLength, "ulcq_territory")
                Required: =true
                Update: =DataCardValue1.Text
                Width: =640
                X: =0
                Y: =3
                ZIndex: =1

                DataCardKey1 As label:
                    AutoHeight: =true
                    FontWeight: =FontWeight.Semibold
                    Height: =48
                    Size: =15
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue1 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: |-
                        =If(
                            Form1_4.Mode = FormMode.New,
                            territory_Combo_2.Selected.Territory,
                            !IsBlank(territory_Combo_2.Selected.Territory),
                            territory_Combo_2.Selected.Territory,
                            Parent.Default
                        )
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Height: =70
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =21
                    Tooltip: =Parent.DisplayName
                    Visible: =false
                    Width: =Parent.Width - 60
                    X: =26
                    Y: =73
                    ZIndex: =2

                ErrorMessage1 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue1.Y + DataCardValue1.Height
                    ZIndex: =3

                StarVisible1 As label:
                    Align: =Align.Center
                    Color: =RGBA(255, 0, 0, 1)
                    Height: =DataCardKey1.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey1.Y
                    ZIndex: =4

                territory_Combo_2 As combobox:
                    ChevronBackground: =RGBA(255, 139, 76, 1)
                    DefaultSelectedItems: =[Parent.Default]
                    DisplayFields: =["ulcq_name"]
                    Height: =70
                    HoverFill: =RGBA(251, 188, 159, 1)
                    IsSearchable: =false
                    Items: =Filter(Area_Territories,Area.Name=DataCardValue7.Selected.Name)
                    SearchFields: =["ulcq_name"]
                    SearchItems: =[]
                    SelectMultiple: =false
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =58
                    ZIndex: =5

            "'QR Code_DataCard2_1' As typedDataCard.addLargePictureCard":
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr86f_qrcode"
                Default: =ThisItem.'QR Code'
                DisplayMode: =DisplayMode.Edit
                DisplayName: =DataSourceInfo([@Attendees],DataSourceInfo.DisplayName,"cr86f_qrcode")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =Image5_1.Image
                Visible: =If(Form1_4.Mode=FormMode.New,true,false)
                Width: =640
                X: =0
                Y: =4
                ZIndex: =1

                DataCardKey7_3 As label:
                    AutoHeight: =true
                    FontWeight: =FontWeight.Semibold
                    Height: =48
                    Size: =15
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                Image5_1 As image:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    DisplayMode: =DisplayMode.Disabled
                    Height: =AddPicture2_1.Height
                    Image: |-
                        =If(
                            IsBlank(DataCardValue1_3.Text) || !IsMatch(
                                DataCardValue1_3.Text,
                                Match.Email
                            ) || (DataCardValue1_3.Text exactin col_allAttendee[@ulcq_email]),
                            SampleImage,
                            "https://quickchart.io/qr?text=" & DataCardValue1_3.Text
                        )
                    Tooltip: =Parent.DisplayName
                    Width: =AddPicture2_1.Width
                    X: =AddPicture2_1.X
                    Y: =AddPicture2_1.Y
                    ZIndex: =2

                AddPicture2_1 As addMedia:
                    Height: =320
                    Text: =""
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey7_3.Y + DataCardKey7_3.Height + 5
                    ZIndex: =3

                ErrorMessage12_1 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =Image5_1.Y + Image5_1.Height
                    ZIndex: =4

                StarVisible12_1 As label:
                    Align: =Align.Center
                    Height: =DataCardKey7_3.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey7_3.Y
                    ZIndex: =5

            Class_DataCard2 As typedDataCard.comboBoxOptionSetSingleEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ulcq_class"
                Default: =ThisItem.Class
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@Attendees],DataSourceInfo.DisplayName,"ulcq_class")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =DataCardValue13.Selected.Value
                Width: =640
                X: =0
                Y: =5
                ZIndex: =1

                DataCardKey15 As label:
                    AutoHeight: =true
                    Height: =48
                    Size: =21
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue13 As combobox:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    ChevronBackground: =RGBA(255, 139, 76, 1)
                    DefaultSelectedItems: =[Parent.Default]
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    Height: =70
                    HoverFill: =RGBA(255, 139, 76, 1)
                    IsSearchable: =false
                    Items: =Choices('Class Set')
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectMultiple: =false
                    Size: =21
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey15.Y + DataCardKey15.Height + 5
                    ZIndex: =2

                ErrorMessage14 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue13.Y + DataCardValue13.Height
                    ZIndex: =3

                StarVisible14 As label:
                    Align: =Align.Center
                    Height: =DataCardKey15.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey15.Y
                    ZIndex: =4

            Channel_DataCard2 As typedDataCard.comboBoxOptionSetSingleEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ulcq_channel"
                Default: =ThisItem.Channel
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@Attendees],DataSourceInfo.DisplayName,"ulcq_channel")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =DataCardValue14.Selected.Value
                Width: =640
                X: =0
                Y: =6
                ZIndex: =1

                DataCardKey19 As label:
                    AutoHeight: =true
                    Height: =48
                    Size: =21
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue14 As combobox:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    ChevronBackground: =RGBA(255, 139, 76, 1)
                    DefaultSelectedItems: =[Parent.Default]
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    Height: =70
                    HoverFill: =RGBA(255, 139, 76, 1)
                    IsSearchable: =false
                    Items: =Choices('Channel Set')
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectMultiple: =false
                    Size: =21
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey19.Y + DataCardKey19.Height + 5
                    ZIndex: =2

                ErrorMessage18 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue14.Y + DataCardValue14.Height
                    ZIndex: =3

                StarVisible18 As label:
                    Align: =Align.Center
                    Height: =DataCardKey19.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey19.Y
                    ZIndex: =4

            Name_DataCard1_2 As typedDataCard.textualEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="ulcq_name"
                Default: =ThisItem.Name
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@Attendees],DataSourceInfo.DisplayName,"ulcq_name")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@Attendees], DataSourceInfo.MaxLength, "ulcq_name")
                Required: =true
                Update: =DataCardValue1_2.Text
                Width: =640
                X: =0
                Y: =0
                ZIndex: =2

                DataCardKey1_2 As label:
                    AutoHeight: =true
                    Color: =RGBA(0, 0, 0, 1)
                    FontWeight: =FontWeight.Semibold
                    Height: =48
                    Size: =15
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue1_2 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Color.Black, Color.Red)
                    BorderThickness: =1
                    Default: |-
                        =Parent.Default
                        //Gallery3.Selected.Name
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Height: =70
                    HintText: ="Surname, Firstname"
                    MaxLength: =Parent.MaxLength
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey1_2.Y + DataCardKey1_2.Height + 5
                    ZIndex: =2

                ErrorMessage1_2 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =24
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue1_2.Y + DataCardValue1_2.Height
                    ZIndex: =3

                StarVisible1_2 As label:
                    Align: =Align.Center
                    Color: =Color.Red
                    Height: =DataCardKey1_2.Height
                    Size: =21
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey1_2.Y
                    ZIndex: =4

        Submitbutton As button:
            BorderThickness: =1
            DisplayMode: |-
                =//If(Form1_2.Valid,DisplayMode.Edit, DisplayMode.Disabled)
                DisplayMode.Edit
            Fill: =RGBA(99, 139, 44, 1)
            Height: =60
            HoverFill: =ColorFade(Self.Fill,-20%)
            OnSelect: |
                =UpdateContext({
                    lcl_Qrimage:Image5_1.Image
                });
                If(
                    DataCardValue1_3.Text exactin Attendees[@Email] && !IsMatch(
                        DataCardValue1_3.Text,
                        Match.Email
                    ),
                    "",
                    If(
                        Form1_4.Mode = FormMode.New,
                        If(
                            IsBlank(DataCardValue1_2.Text) || IsBlank(DataCardValue7.Selected.Name) || IsBlank(territory_Combo_2.Selected.Territory) || IsBlank(DataCardValue13.Selected.Value) || IsBlank(DataCardValue1_3.Text)||IsBlank(DataCardValue14.Selected.Value),
                            UpdateContext({_V_errormsg: true}),
                            UpdateContext({_V_email: DataCardValue1_3.Text});
                            Patch(
                                col_allAttendee,
                                Defaults(col_allAttendee),
                                    {
                                        Name: DataCardValue1_2.Text,
                                        Territory: territory_Combo_2.Selected.Name,
                                        Class:DataCardValue13.Selected.Value,
                                        Area:DataCardValue7.Selected,
                                        Channel:DataCardValue14.Selected.Value,
                                        'QR Code':lcl_Qrimage,
                                        Email: _V_email,
                                        QR_Link: "https://quickchart.io/qr?text=" & _V_email
                                    }    
                                );
                            Patch(
                                Attendees,
                                
                                Defaults(Attendees),
                                   
                                // UpdateContext({_V_email: DataCardValue1_3.Text});
                                {
                                    Name: DataCardValue1_2.Text,
                                    Territory: territory_Combo_2.Selected.Territory,
                                    Class: DataCardValue13.Selected.Value,
                                    Area:DataCardValue7.Selected,
                                    Channel:DataCardValue14.Selected.Value,
                                    'QR Code': lcl_Qrimage,
                                    Email: _V_email,
                                    QR_Link: "https://quickchart.io/qr?text=" & _V_email
                                }
                            );
                            
                //SubmitForm(Form1_4);
                UpdateContext({_V_errormsg: false});
                           /* ClearCollect(
                                col_allAttendee,
                                Attendees
                            );*/
                
                
                            
                            //Navigate(Attendee_Screen);
                        ),
                        If(
                            Form1_4.Mode = FormMode.Edit,
                            SubmitForm(Form1_4);
                            Patch(col_allAttendee,
                            LookUp(
                                        col_allAttendee,
                                        Attendees = _V_id
                                    ),
                            {
                                 Name: DataCardValue1_2.Text,
                                    Territory: territory_Combo_2.Selected.Name,
                                    Class: DataCardValue13.Selected.Value,
                                    Channel:DataCardValue14.Selected.Value,
                                    Area:DataCardValue7.Selected
                                    //'QR Code': Image5_1.Image,
                                   // Email: _V_email,
                                   // QR_Link: "https://quickchart.io/qr?text=" & _V_email
                            });
                           // Refresh(Attendees);
                            /*ClearCollect(
                                col_allAttendee,
                                Attendees
                            );*/
                           
                            
                        )
                    );
                    Switch(LookUp(Users,'Full Name'=User().FullName).'Roles (ulcq_Roles)'.Name,
                            "ASM",
                                ClearCollect(col_allAttendee, 
                                    Filter(Attendees, Territory = LookUp(Users,'Full Name'=User().FullName,Territory).Name
                                    )
                                ),
                            "RSM",
                                ClearCollect(col_allAttendee, 
                                    Filter(Attendees, Area.Name = LookUp(Users,'Full Name'=User().FullName,Area).Name
                                    )
                                ),
                            "BEx",
                                ClearCollect(col_allAttendee,
                                        Attendees
                                    ),
                            "MD",
                            ClearCollect(col_allAttendee,
                                        Attendees
                                    ),
                            "CULINARY",
                            ClearCollect(col_allAttendee,
                                        Attendees
                                    ),
                            "CAPABILITY",
                            ClearCollect(col_allAttendee,
                                        Attendees
                                    )
                
                    );        
                    
                Navigate(Attendee_Screen)
                );
            PressedFill: =RGBA(204, 72, 0, 1)
            Size: =20
            Text: ="Submit"
            Width: =207
            X: =362
            Y: =1040
            ZIndex: =2

        Button2_4 As button:
            BorderThickness: =1
            Fill: =RGBA(255, 0, 0, 1)
            Height: =60
            HoverFill: =RGBA(204, 72, 0, 1)
            OnSelect: =Navigate(Attendee_Screen)
            PressedFill: =RGBA(204, 72, 0, 1)
            Size: =20
            Text: ="Cancel"
            Width: =207
            X: =56
            Y: =1040
            ZIndex: =3

        Label4 As label:
            Color: =RGBA(255, 0, 0, 1)
            Height: =41
            Size: =12
            Text: ="* Please fill all the mandatory fields"
            Visible: =_V_errormsg
            Width: =278
            X: =Submitbutton.X
            Y: =Submitbutton.Y+Submitbutton.Height
            ZIndex: =5

        HeaderComponent_10 As HeaderComponent:
            BackScreen: =Dashboard_Screen
            ZIndex: =6

