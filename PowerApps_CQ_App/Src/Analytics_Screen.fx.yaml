Analytics_Screen As screen:
    BackgroundImage: ='f2b6241e61447d42e2bc41f763078a55a5242da5-1920x1080'
    Fill: =
    ImagePosition: =ImagePosition.Fill
    OnVisible: |-
        =ClearCollect(col_SameAreaAttendees,Filter(Attendees,Area.Name=LookUp(Users,'Full Name'=User().FullName).Area.Name));
        Set(_V_sortedgal,true);
        Set(_V_galVisible,true)

    Cont_Inner As groupContainer.manualLayoutContainer:
        Height: =Parent.Height-HeaderComponent_24.Height
        Visible: =false
        Width: =Parent.Width
        Y: =HeaderComponent_24.Height
        ZIndex: =2

        gal_attendees As gallery.variableTemplateHeightGallery:
            DelayItemLoading: =true
            Height: =Parent.Height-(ComboBox1.Height+Container4_10.Height+110)
            Items: |-
                =//Filter(Attendees,Area.Name=LookUp(Users,'Full Name'=User().FullName).Area.Name)
                If(_V_sortedgal,Sort(Col_galItems,Percentage,SortOrder.Descending),Col_galItems)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateFill: =If(ThisItem.Percentage=First(Sort(Col_galItems,Percentage,SortOrder.Descending)).Percentage,Color.LightGreen,Color.LightGray)
            TemplateSize: =80
            Visible: =_V_galVisible
            Y: =100+Container4_10.Height+80
            ZIndex: =1

            Label26_1 As label:
                FontWeight: =FontWeight.Semibold
                Height: =70
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: =ThisItem.Name
                Width: =Parent.TemplateWidth/2
                X: =12
                ZIndex: =1

            Label28 As label:
                Align: =Align.Center
                Color: =If(ThisItem.Percentage>=75,Color.Green,Color.Red)
                FontWeight: =FontWeight.Bold
                Height: =70
                OnSelect: =Select(Parent)
                Size: =15
                Text: |-
                    =If(ThisItem.Percentage=Blank(),"N/A",Text(ThisItem.Percentage,"#.#")&"%")
                Width: =Parent.TemplateWidth/2
                X: =Label26_1.Width
                ZIndex: =2

            Button4 As button:
                Height: =35
                OnSelect: =Select(Parent)
                Size: =24
                Text: ="Button"
                Visible: |-
                    =//ThisItem.Percentage=First(Sort(Col_galItems,Percentage,SortOrder.Descending)).Percentage
                    false
                Width: =97
                X: =172
                Y: =17
                ZIndex: =3

        ComboBox1 As combobox:
            ChevronBackground: =RGBA(224, 86, 6, 1)
            DisplayFields: =["ulcq_name"]
            Height: =70
            HoverFill: =RGBA(253, 207, 180, 1)
            InputTextPlaceholder: ="Select Module"
            Items: ='Module Names'
            OnChange: |-
                =/*ForAll(
                    col_SameAreaAttendees As SA,
                    Collect(
                        Col_galItems,
                        {
                            Name: SA.Name,
                            Percentage: Sum(
                                Filter(
                                    Results,
                                    Name = SA.Name,
                                    'Module Type'.Name = Self.Selected.Name,
                                    Text(
                                        Date,
                                        "mm"
                                    ) = Text(
                                        Now(),
                                        "mm"
                                    )
                                ),
                                Percentage
                            )
                        }
                    )
                );*/
                Clear(Col_galItems);
                Set(_V_galVisible,true);
                Clear(col_examsid);
                Collect(
                    col_examsid,
                    Distinct(
                        Filter(
                            Results,
                            //Name = "Adhikary,Jamini",
                            'Module Type'.Name = Self.Selected.Name,
                            Text(
                                Date,
                                "mm"
                            ) = Text(
                                Now(),
                                "mm"
                            ),
                            !IsBlank(ExamID)
                        ),
                        ExamID
                    )
                );
                Set(_V_totalExam,CountRows(col_examsid));
                ForAll(
                    /*col_SameAreaAttendees*/col_allAttendee As SA,
                    Collect(
                        Col_galItems,
                        {
                            Name: SA.Name,
                            Percentage: Sum(
                                Filter(
                                    Results,
                                    Name = SA.Name,
                                    'Module Type'.Name = Self.Selected.Name,
                                    Text(
                                        Date,
                                        "mm"
                                    ) = Text(
                                        Now(),
                                        "mm"
                                    )
                                ),
                                Percentage/_V_totalExam
                            )
                        }
                    )
                );
            OnSelect: =
            SearchFields: =["ulcq_name"]
            SearchItems: =Search('Module Names',ComboBox1.SearchText,"ulcq_name")
            SelectMultiple: =false
            Size: =15
            Width: =575
            X: =30
            Y: =20
            ZIndex: =2

        Container4_10 As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.Regular
            Fill: =RGBA(214, 221, 224, 1)
            Height: =70
            PaddingTop: =10
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Visible: =_V_galVisible
            Width: =637
            X: =3
            Y: =ComboBox1.Height+100
            ZIndex: =3

            Module_Type_Label_6 As label:
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =15
                Text: ="Attendee Name"
                Width: =Parent.Width/2
                X: =15
                ZIndex: =2

            Percentage_Label_2 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =70
                Size: =15
                Text: ="Percentage"
                Width: =Parent.Width/2
                X: =Module_Type_Label_6.Width
                ZIndex: =3

            Icon11 As icon.ArrowsUpDown:
                Height: =35
                Icon: =Icon.Sort
                OnSelect: |
                    =Set(_V_sortedgal,true);
                Visible: =false
                Width: =35
                X: =573
                Y: =Parent.Height/4
                ZIndex: =4

        CompositeColumnChart1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =4

            Title1 As label:
                Align: =Align.Center
                Height: =41
                Text: =""
                Visible: =!_V_galVisible
                Width: =640
                Y: =162
                ZIndex: =4

            ColumnChart1 As barChart:
                GridStyle: =GridStyle.All
                Height: =883
                Items: |-
                    =If(
                        _V_sortedgal,
                        Sort(
                            Col_galItems,
                            Percentage,
                            SortOrder.Descending
                        ),
                        Col_galItems
                    )
                ItemsGap: =5
                Size: =15
                Visible: =!_V_galVisible
                Width: =640
                XLabelAngle: =30
                Y: =162
                ZIndex: =5

            Legend1 As legend:
                Height: =140
                ItemColorSet: =ColumnChart1.ItemColorSet
                Items: =ColumnChart1.SeriesLabels
                Size: =18
                Visible: =!_V_galVisible
                Width: =194
                X: =446
                Y: =162
                ZIndex: =6

        CompositePieChart1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =8

            Title2 As label:
                Align: =Align.Center
                Height: =25
                Text: ="Chart Title"
                Visible: =false
                Width: =400
                X: =40
                Y: =40
                ZIndex: =7

            PieChart1 As pieChart:
                Height: =611
                Items: =If(_V_sortedgal,Sort(Col_galItems,Percentage,SortOrder.Descending),Col_galItems)
                Visible: =false
                Width: =640
                Y: =175
                ZIndex: =8

            Legend2 As legend:
                Height: =200
                ItemColorSet: =PieChart1.ItemColorSet
                Items: =PieChart1.SeriesLabels
                Size: =16
                Visible: =false
                Width: =400
                X: =46
                Y: =805
                ZIndex: =9

        Icon12 As icon.OptionsList:
            Color: =RGBA(0, 0, 0, 1)
            Height: =40
            Icon: =Icon.OptionsList
            OnSelect: =Set(_V_galVisible,true)
            Tooltip: ="Gallery View"
            Visible: =!_V_galVisible
            Width: =40
            X: =568
            Y: =110
            ZIndex: =10

        Image5_2 As image:
            Height: =Parent.Height
            Image: ='f2b6241e61447d42e2bc41f763078a55a5242da5-1920x1080'
            ImagePosition: =ImagePosition.Fill
            OnSelect: =Set(_V_galVisible, false);
            Tooltip: ="Chart View"
            Visible: |-
                =//_V_galVisible
                true
            Width: =Parent.Width
            ZIndex: =11

    HeaderComponent_24 As HeaderComponent_21:
        BackScreen: =Dashboard_Screen
        ZIndex: =3

    mainContainer10 As groupContainer.manualLayoutContainer:
        Height: =Parent.Height-HeaderComponent_24.Height
        Width: =Parent.Width
        Y: =90
        ZIndex: =7

        Container11 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(0, 0, 0, 0.4)
            Height: =Parent.Height
            Width: =Parent.Width
            ZIndex: =1

        Cont_Inner_1 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =959
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =Parent.Width
            Y: =87
            ZIndex: =2

            gal_attendees_1 As gallery.variableTemplateHeightGallery:
                DelayItemLoading: =true
                Height: =754
                Items: |-
                    =//Filter(Attendees,Area.Name=LookUp(Users,'Full Name'=User().FullName).Area.Name)
                    With(
                        {
                            records: If(
                                _V_sortedgalbyPercentage,
                                Sort(
                                    Filter(
                                        Col_galItems,
                                        Text(
                                            Date,
                                            "dd/mm/yyyy"
                                        ) = Text(
                                            DatePicker1.SelectedDate,
                                            "dd/mm/yyyy"
                                        )
                                    ),
                                    Percentage,
                                    SortOrder.Descending
                                ),
                                Filter(
                                    Col_galItems,
                                    Text(
                                        Date,
                                        "dd/mm/yyyy"
                                    ) = Text(
                                        DatePicker1.SelectedDate,
                                        "dd/mm/yyyy"
                                    )
                                )
                            )
                        },
                        ForAll(
                            Sequence(CountRows(records)),
                            Patch(
                                Last(
                                    FirstN(
                                        records,
                                        Value
                                    )
                                ),
                                {rowNumber: Value}
                            )
                        )
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplateFill: |-
                    =//If(ThisItem.Percentage=First(Sort(Col_galItems,Percentage,SortOrder.Descending)).Percentage,Color.LightGreen,Color.LightGray)
                    If(Mod(ThisItem.rowNumber,2)=0,Color.LightGray,Color.White)
                TemplateSize: =80
                Visible: =_V_galVisible
                Width: =Parent.Width-40
                X: =20
                Y: =189
                ZIndex: =1

                Label26_2 As label:
                    FontWeight: =FontWeight.Semibold
                    Height: =70
                    OnSelect: =Select(Parent)
                    PaddingLeft: =12
                    Text: =ThisItem.Name
                    Width: =Parent.TemplateWidth/2
                    X: =12
                    ZIndex: =1

                Label28_1 As label:
                    Color: |-
                        =If(
                            ThisItem.Percentage/_V_totalExam < 80,
                            Color.Red,
                            If(
                                ThisItem.Percentage/_V_totalExam < 100,
                                Color.Yellow,
                                Color.Green
                            )
                        )
                    FontWeight: =FontWeight.Bold
                    Height: =70
                    OnSelect: =Select(Parent)
                    Size: =15
                    Text: |-
                        =If(ThisItem.Percentage=Blank(),"N/A",Text(ThisItem.Percentage/_V_totalExam,"#.#")&"%")
                    Width: =Parent.TemplateWidth/3
                    X: =350
                    ZIndex: =2

            ComboBox1_1 As combobox:
                ChevronBackground: =RGBA(224, 86, 6, 1)
                DefaultSelectedItems: ='Module Names'
                DisplayFields: =["ulcq_name"]
                Height: =50
                HoverFill: =RGBA(253, 207, 180, 1)
                InputTextPlaceholder: ="Select Module"
                Items: ='Module Names'
                OnChange: |-
                    =/*ForAll(
                        col_SameAreaAttendees As SA,
                        Collect(
                            Col_galItems,
                            {
                                Name: SA.Name,
                                Percentage: Sum(
                                    Filter(
                                        Results,
                                        Name = SA.Name,
                                        'Module Type'.Name = Self.Selected.Name,
                                        Text(
                                            Date,
                                            "mm"
                                        ) = Text(
                                            Now(),
                                            "mm"
                                        )
                                    ),
                                    Percentage
                                )
                            }
                        )
                    );*/
                    Clear(Col_galItems);
                    Set(_V_galVisible,true);
                    Clear(col_examsid);
                    //ForAll(col_allAttendee As AA,
                    Collect(
                        col_examsid,
                        Distinct(
                            Filter(
                                Results,
                                //Name = AA.Name,
                                'Module Type'.Name = Self.Selected.Name,
                                Text(
                                    Date,
                                    "mm"
                                ) = Text(
                                    Now(),
                                    "mm"
                                ),
                                !IsBlank(ExamID)
                            ),
                            ExamID
                        )
                    );
                    Set(_V_totalExam,CountRows(col_examsid));
                    ForAll(
                        col_allAttendee As SA,
                        Collect(
                            Col_galItems,
                            {
                                Name: SA.Name,
                                //Date: SA.
                                Date : First(Filter(
                                        Results,
                                        Name = SA.Name,
                                        'Module Type'.Name = Self.Selected.Name,
                                        Text(
                                            Date,
                                            "mm"
                                        ) = Text(
                                            Now(),
                                            "mm"
                                        )
                                    )).Date,
                                Percentage: Sum(
                                    Filter(
                                        Results,
                                        Name = SA.Name,
                                        'Module Type'.Name = Self.Selected.Name,
                                        Text(
                                            Date,
                                            "mm"
                                        ) = Text(
                                            Now(),
                                            "mm"
                                        )
                                    ),
                                    Percentage/_V_totalExam
                                )
                            }
                        )
                    );
                OnSelect: =
                SearchFields: =["ulcq_name"]
                SearchItems: =Search('Module Names',ComboBox1_1.SearchText,"ulcq_name")
                SelectMultiple: =false
                Width: =383
                X: =20
                Y: =31
                ZIndex: =2

            Container4_11 As groupContainer.manualLayoutContainer:
                DropShadow: =DropShadow.Regular
                Fill: =Color.LightGray
                Height: =70
                PaddingTop: =10
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Visible: =_V_galVisible
                Width: =Parent.Width-50
                X: =25
                Y: =111
                ZIndex: =3

                Module_Type_Label_7 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =70
                    Size: =15
                    Text: |-
                        ="Attendee Name"&" ("&CountRows(Filter(
                                            Col_galItems,
                                            Text(
                                                Date,
                                                "dd/mm/yyyy"
                                            ) = Text(
                                                DatePicker1.SelectedDate,
                                                "dd/mm/yyyy"
                                            )
                                        ))&")"
                    Width: =Parent.Width/2-40
                    X: =15
                    ZIndex: =2

                Percentage_Label_3 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =70
                    Size: =15
                    Text: ="Percentage"
                    Width: =Parent.Width/3
                    X: =350
                    ZIndex: =3

                Icon11_2 As icon.ArrowsUpDown:
                    Color: =RGBA(0, 0, 0, 1)
                    Height: =30
                    Icon: =Icon.Sort
                    OnSelect: |
                        =If(_V_sortedgalbyPercentage,Set(_V_sortedgalbyPercentage,false),Set(_V_sortedgalbyPercentage,true));
                    Width: =30
                    X: =550
                    Y: =Parent.Height/3.5
                    ZIndex: =4

                Icon11_1 As icon.ArrowsUpDown:
                    Color: =RGBA(0, 0, 0, 1)
                    Height: =30
                    Icon: =Icon.Sort
                    OnSelect: |
                        =Set(_V_sortedgalbyAttendeeName,true);
                    Width: =30
                    X: =Module_Type_Label_7.Width-20
                    Y: =Parent.Height/3.5
                    ZIndex: =5

            DatePicker1 As datepicker:
                BorderColor: =RGBA(0, 0, 0, 1)
                DefaultDate: =//Today()
                Height: =50
                IconBackground: =Color.OrangeRed
                Size: =13
                Width: =175
                X: =430
                Y: =ComboBox1_1.Y
                ZIndex: =4

        Image5_4 As image:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =40
            Image: =backarrow
            OnSelect: =Navigate(Dashboard_Screen,ScreenTransition.Fade)
            RadiusBottomLeft: =100
            RadiusBottomRight: =100
            RadiusTopLeft: =100
            RadiusTopRight: =100
            Width: =40
            X: =20
            Y: =23
            ZIndex: =3

    Label31 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        FontWeight: =FontWeight.Bold
        Height: =70
        Size: =21
        Text: ="Analytics"
        Width: =507
        X: =66
        Y: =102
        ZIndex: =8

